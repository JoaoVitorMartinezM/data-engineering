[2025-11-24T19:03:27.226+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_spark_working.execute_silver_layer scheduled__2025-11-23T00:00:00+00:00 [queued]>
[2025-11-24T19:03:27.234+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_spark_working.execute_silver_layer scheduled__2025-11-23T00:00:00+00:00 [queued]>
[2025-11-24T19:03:27.235+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2025-11-24T19:03:27.247+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): execute_silver_layer> on 2025-11-23 00:00:00+00:00
[2025-11-24T19:03:27.253+0000] {standard_task_runner.py:60} INFO - Started process 1884 to run task
[2025-11-24T19:03:27.256+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'etl_spark_working', 'execute_silver_layer', 'scheduled__2025-11-23T00:00:00+00:00', '--job-id', '33', '--raw', '--subdir', 'DAGS_FOLDER/etl_spark_working_dag.py', '--cfg-path', '/tmp/tmpkiob5xm9']
[2025-11-24T19:03:27.258+0000] {standard_task_runner.py:88} INFO - Job 33: Subtask execute_silver_layer
[2025-11-24T19:03:27.322+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_spark_working.execute_silver_layer scheduled__2025-11-23T00:00:00+00:00 [running]> on host 7934b6c65b02
[2025-11-24T19:03:27.409+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='data-engineer' AIRFLOW_CTX_DAG_ID='etl_spark_working' AIRFLOW_CTX_TASK_ID='execute_silver_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-11-23T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-11-23T00:00:00+00:00'
[2025-11-24T19:03:27.410+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-24T19:03:27.411+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', '\n    echo "ü•à ========== EXECUTANDO SILVER LAYER =========="\n    echo "üìÖ Data: $(date)"\n    echo "üîß Executor: Docker Exec"\n    \n    # Executar script via Docker\n    if docker exec spark_master python3 /opt/spark/work-dir/silver_script.py; then\n        echo "‚úÖ Silver Layer executado com sucesso!"\n        \n        # Aguardar para garantir que dados foram escritos\n        sleep 5\n        \n        echo "üìä Verificando dados gerados..."\n        echo "=============================================="\n    else\n        echo "‚ùå ERRO: Falha na execu√ß√£o do Silver Layer"\n        exit 1\n    fi\n    ']
[2025-11-24T19:03:27.422+0000] {subprocess.py:86} INFO - Output:
[2025-11-24T19:03:27.423+0000] {subprocess.py:93} INFO - ü•à ========== EXECUTANDO SILVER LAYER ==========
[2025-11-24T19:03:27.426+0000] {subprocess.py:93} INFO - üìÖ Data: Mon Nov 24 19:03:27 UTC 2025
[2025-11-24T19:03:27.427+0000] {subprocess.py:93} INFO - üîß Executor: Docker Exec
[2025-11-24T19:03:29.402+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-11-24T19:03:29.403+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-11-24T19:03:29.620+0000] {subprocess.py:93} INFO - 25/11/24 19:03:29 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-11-24T19:03:32.485+0000] {subprocess.py:93} INFO - 25/11/24 19:03:32 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[2025-11-24T19:03:40.288+0000] {subprocess.py:93} INFO - [Stage 0:>                                                          (0 + 2) / 2]                                                                                25/11/24 19:03:40 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[2025-11-24T19:03:51.853+0000] {subprocess.py:93} INFO - [Stage 3:>                                                         (0 + 8) / 50][Stage 3:===>                                                     (3 + 13) / 50][Stage 3:==========>                                               (9 + 8) / 50][Stage 3:====================>                                    (18 + 8) / 50][Stage 3:=============================>                           (26 + 8) / 50][Stage 3:=====================================>                   (33 + 8) / 50][Stage 3:===============================================>         (42 + 8) / 50]                                                                                [Stage 5:=======================================>                 (35 + 7) / 50]                                                                                [Stage 9:>                                                          (0 + 1) / 1]                                                                                [Stage 15:>                                                         (0 + 1) / 1]
[2025-11-24T19:03:51.854+0000] {subprocess.py:93} INFO - --- LENDO DADOS BRONZE ---
[2025-11-24T19:03:51.855+0000] {subprocess.py:93} INFO - +------+-------------+-------------+--------------------+-----------------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+---------------+-------------------+-----------------+----------------------+----------------------+---------------+
[2025-11-24T19:03:51.855+0000] {subprocess.py:93} INFO - |   _c0|  ID_PACIENTE|         DATA|     HOR√ÅRIO_CHEGADA|           DATA_2|  HOR√ÅRIO_CHEGADA_2|     SEXO|IDADE|PESO_kg|ALTURA_m|  IMC|     ETAPA|CAFE√çNA|DIETA_NAS_√öLTIMAS_24_H|ATIVIDADE_mCi_Repouso|HORA_INJE√á√ÉO_Repouso|HORA_IMAGEM_Repouso|ATIVIDADE_mCi_Esfor√ßo|HORA_INJE√á√ÉO_Esfor√ßo|HORA_IMAGEM_Esfor√ßo|REPETIU|ETAPA_REPETI√á√ÉO|MOTIVO_DE_REPETI√á√ÉO|PREPARO_REPETI√á√ÉO|HORA_REPETI√á√ÉO_Repouso|HORA_REPETI√á√ÉO_Estress|N_num_REPETI√á√ÉO|
[2025-11-24T19:03:51.856+0000] {subprocess.py:93} INFO - +------+-------------+-------------+--------------------+-----------------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+---------------+-------------------+-----------------+----------------------+----------------------+---------------+
[2025-11-24T19:03:51.856+0000] {subprocess.py:93} INFO - |TOTAL"|DELTA Repouso|DELTA Esfor√ßo|TEMPO TOTAL ATIVI...|TEMPO PERMANENCIA|               NULL|     NULL| NULL|   NULL|    NULL| NULL|      NULL|   NULL|                  NULL|                 NULL|                NULL|               NULL|                 NULL|                NULL|               NULL|   NULL|           NULL|               NULL|             NULL|                  NULL|                  NULL|           NULL|
[2025-11-24T19:03:51.857+0000] {subprocess.py:93} INFO - |     0|       235310|   2025-03-03| 2025-11-22 11:39:00|       2025-03-06|2025-11-22 12:19:00|Masculino|   35|     90|    1.69|31.51|Incompleta|  false|  P√£es, Carne Verme...|                 18.0| 2025-11-22 12:40:00|2025-11-22 13:45:00|                 18.0| 2025-11-22 12:10:00|2025-11-22 13:04:00|  false|           NULL|               NULL|             NULL|                  NULL|                  NULL|              0|
[2025-11-24T19:03:51.857+0000] {subprocess.py:93} INFO - +------+-------------+-------------+--------------------+-----------------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+---------------+-------------------+-----------------+----------------------+----------------------+---------------+
[2025-11-24T19:03:51.858+0000] {subprocess.py:93} INFO - only showing top 2 rows
[2025-11-24T19:03:51.858+0000] {subprocess.py:93} INFO - 
[2025-11-24T19:03:51.859+0000] {subprocess.py:93} INFO - --- TRATANDO DADOS ---
[2025-11-24T19:03:51.859+0000] {subprocess.py:93} INFO - --- MOSTRANDO DADOS ---
[2025-11-24T19:03:51.859+0000] {subprocess.py:93} INFO - +-----------+----------+-------------------+----------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+----------------+--------------------+--------------------+----------------------+----------------------+---------------+
[2025-11-24T19:03:51.860+0000] {subprocess.py:93} INFO - |ID_PACIENTE|      DATA|    HOR√ÅRIO_CHEGADA|    DATA_2|  HOR√ÅRIO_CHEGADA_2|     SEXO|IDADE|PESO_kg|ALTURA_m|  IMC|     ETAPA|CAFE√çNA|DIETA_NAS_√öLTIMAS_24_H|ATIVIDADE_mCi_Repouso|HORA_INJE√á√ÉO_Repouso|HORA_IMAGEM_Repouso|ATIVIDADE_mCi_Esfor√ßo|HORA_INJE√á√ÉO_Esfor√ßo|HORA_IMAGEM_Esfor√ßo|REPETIU| ETAPA_REPETI√á√ÉO| MOTIVO_DE_REPETI√á√ÉO|   PREPARO_REPETI√á√ÉO|HORA_REPETI√á√ÉO_Repouso|HORA_REPETI√á√ÉO_Estress|N_num_REPETI√á√ÉO|
[2025-11-24T19:03:51.860+0000] {subprocess.py:93} INFO - +-----------+----------+-------------------+----------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+----------------+--------------------+--------------------+----------------------+----------------------+---------------+
[2025-11-24T19:03:51.861+0000] {subprocess.py:93} INFO - |     209233|2025-03-05|2025-11-22 09:12:00|2025-03-06|2025-11-22 09:15:00|Masculino|   68|     84|    1.72|28.39|Incompleta|  false|  P√£es, Aves, Leite...|                 16.0| 2025-11-22 09:25:00|2025-11-22 10:33:00|                 16.0| 2025-11-22 10:45:00|2025-11-22 11:28:00|   true|Repouso, Esfor√ßo|Atividade Hepatic...|√Ågua com G√°s, Lei...|   2025-11-22 11:27:00|   2025-11-22 12:34:00|              1|
[2025-11-24T19:03:51.861+0000] {subprocess.py:93} INFO - |     235366|2025-03-06|2025-11-22 12:44:00|2025-03-07|2025-11-22 10:50:00| Feminino|   75|     62|    1.68|21.97|Incompleta|  false|  P√£es, Cereais, Gr...|                 15.0| 2025-11-22 13:25:00|2025-11-22 14:37:00|                 15.0| 2025-11-22 12:05:00|2025-11-22 12:56:00|   true|         Repouso|                NULL|                NULL|   2025-11-22 15:13:00|                  NULL|              1|
[2025-11-24T19:03:51.863+0000] {subprocess.py:93} INFO - +-----------+----------+-------------------+----------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+----------------+--------------------+--------------------+----------------------+----------------------+---------------+
[2025-11-24T19:03:51.863+0000] {subprocess.py:93} INFO - only showing top 2 rows
[2025-11-24T19:03:51.864+0000] {subprocess.py:93} INFO - 
[2025-11-24T19:03:51.865+0000] {subprocess.py:93} INFO - --- ESCREVENDO DADOS EM SILVER ---
[2025-11-24T19:03:51.866+0000] {subprocess.py:93} INFO - Delta Lake Time Travel conclu√≠do com sucesso!
[2025-11-24T19:03:52.283+0000] {subprocess.py:93} INFO - ‚úÖ Silver Layer executado com sucesso!
[2025-11-24T19:03:57.285+0000] {subprocess.py:93} INFO - üìä Verificando dados gerados...
[2025-11-24T19:03:57.286+0000] {subprocess.py:93} INFO - ==============================================
[2025-11-24T19:03:57.287+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-24T19:03:57.344+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_spark_working, task_id=execute_silver_layer, execution_date=20251123T000000, start_date=20251124T190327, end_date=20251124T190357
[2025-11-24T19:03:57.404+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-11-24T19:03:57.464+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
