[2025-11-24T19:05:01.774+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_spark_working.execute_silver_layer manual__2025-11-24T19:03:02+00:00 [queued]>
[2025-11-24T19:05:01.782+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_spark_working.execute_silver_layer manual__2025-11-24T19:03:02+00:00 [queued]>
[2025-11-24T19:05:01.783+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2025-11-24T19:05:01.796+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): execute_silver_layer> on 2025-11-24 19:03:02+00:00
[2025-11-24T19:05:01.800+0000] {standard_task_runner.py:60} INFO - Started process 2055 to run task
[2025-11-24T19:05:01.803+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'etl_spark_working', 'execute_silver_layer', 'manual__2025-11-24T19:03:02+00:00', '--job-id', '40', '--raw', '--subdir', 'DAGS_FOLDER/etl_spark_working_dag.py', '--cfg-path', '/tmp/tmpfm6_fls4']
[2025-11-24T19:05:01.806+0000] {standard_task_runner.py:88} INFO - Job 40: Subtask execute_silver_layer
[2025-11-24T19:05:01.870+0000] {task_command.py:423} INFO - Running <TaskInstance: etl_spark_working.execute_silver_layer manual__2025-11-24T19:03:02+00:00 [running]> on host 7934b6c65b02
[2025-11-24T19:05:01.962+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='data-engineer' AIRFLOW_CTX_DAG_ID='etl_spark_working' AIRFLOW_CTX_TASK_ID='execute_silver_layer' AIRFLOW_CTX_EXECUTION_DATE='2025-11-24T19:03:02+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-24T19:03:02+00:00'
[2025-11-24T19:05:01.963+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-24T19:05:01.964+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', '\n    echo "ü•à ========== EXECUTANDO SILVER LAYER =========="\n    echo "üìÖ Data: $(date)"\n    echo "üîß Executor: Docker Exec"\n    \n    # Executar script via Docker\n    if docker exec spark_master python3 /opt/spark/work-dir/silver_script.py; then\n        echo "‚úÖ Silver Layer executado com sucesso!"\n        \n        # Aguardar para garantir que dados foram escritos\n        sleep 5\n        \n        echo "üìä Verificando dados gerados..."\n        echo "=============================================="\n    else\n        echo "‚ùå ERRO: Falha na execu√ß√£o do Silver Layer"\n        exit 1\n    fi\n    ']
[2025-11-24T19:05:01.973+0000] {subprocess.py:86} INFO - Output:
[2025-11-24T19:05:01.974+0000] {subprocess.py:93} INFO - ü•à ========== EXECUTANDO SILVER LAYER ==========
[2025-11-24T19:05:01.976+0000] {subprocess.py:93} INFO - üìÖ Data: Mon Nov 24 19:05:01 UTC 2025
[2025-11-24T19:05:01.977+0000] {subprocess.py:93} INFO - üîß Executor: Docker Exec
[2025-11-24T19:05:04.014+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-11-24T19:05:04.014+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-11-24T19:05:04.217+0000] {subprocess.py:93} INFO - 25/11/24 19:05:04 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-11-24T19:05:06.843+0000] {subprocess.py:93} INFO - 25/11/24 19:05:06 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
[2025-11-24T19:05:14.103+0000] {subprocess.py:93} INFO - [Stage 0:===================>                                       (1 + 2) / 3]                                                                                25/11/24 19:05:14 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[2025-11-24T19:05:25.855+0000] {subprocess.py:93} INFO - [Stage 3:>                                                         (0 + 8) / 50][Stage 3:=========>                                                (8 + 8) / 50][Stage 3:=============>                                          (12 + 10) / 50][Stage 3:====================>                                    (18 + 9) / 50][Stage 3:=============================>                           (26 + 8) / 50][Stage 3:=======================================>                 (35 + 8) / 50][Stage 3:============================================>            (39 + 9) / 50]                                                                                [Stage 5:=====================================>                   (33 + 9) / 50][Stage 5:======================================================>  (48 + 2) / 50]                                                                                [Stage 16:======================================>                 (34 + 8) / 50]                                                                                [Stage 22:>                                                         (0 + 1) / 1]
[2025-11-24T19:05:25.856+0000] {subprocess.py:93} INFO - --- LENDO DADOS BRONZE ---
[2025-11-24T19:05:25.857+0000] {subprocess.py:93} INFO - +------+-------------+-------------+--------------------+-----------------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+---------------+-------------------+-----------------+----------------------+----------------------+---------------+
[2025-11-24T19:05:25.858+0000] {subprocess.py:93} INFO - |   _c0|  ID_PACIENTE|         DATA|     HOR√ÅRIO_CHEGADA|           DATA_2|  HOR√ÅRIO_CHEGADA_2|     SEXO|IDADE|PESO_kg|ALTURA_m|  IMC|     ETAPA|CAFE√çNA|DIETA_NAS_√öLTIMAS_24_H|ATIVIDADE_mCi_Repouso|HORA_INJE√á√ÉO_Repouso|HORA_IMAGEM_Repouso|ATIVIDADE_mCi_Esfor√ßo|HORA_INJE√á√ÉO_Esfor√ßo|HORA_IMAGEM_Esfor√ßo|REPETIU|ETAPA_REPETI√á√ÉO|MOTIVO_DE_REPETI√á√ÉO|PREPARO_REPETI√á√ÉO|HORA_REPETI√á√ÉO_Repouso|HORA_REPETI√á√ÉO_Estress|N_num_REPETI√á√ÉO|
[2025-11-24T19:05:25.858+0000] {subprocess.py:93} INFO - +------+-------------+-------------+--------------------+-----------------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+---------------+-------------------+-----------------+----------------------+----------------------+---------------+
[2025-11-24T19:05:25.859+0000] {subprocess.py:93} INFO - |TOTAL"|DELTA Repouso|DELTA Esfor√ßo|TEMPO TOTAL ATIVI...|TEMPO PERMANENCIA|               NULL|     NULL| NULL|   NULL|    NULL| NULL|      NULL|   NULL|                  NULL|                 NULL|                NULL|               NULL|                 NULL|                NULL|               NULL|   NULL|           NULL|               NULL|             NULL|                  NULL|                  NULL|           NULL|
[2025-11-24T19:05:25.860+0000] {subprocess.py:93} INFO - |     0|       235310|   2025-03-03| 2025-11-22 11:39:00|       2025-03-06|2025-11-22 12:19:00|Masculino|   35|     90|    1.69|31.51|Incompleta|  false|  P√£es, Carne Verme...|                 18.0| 2025-11-22 12:40:00|2025-11-22 13:45:00|                 18.0| 2025-11-22 12:10:00|2025-11-22 13:04:00|  false|           NULL|               NULL|             NULL|                  NULL|                  NULL|              0|
[2025-11-24T19:05:25.860+0000] {subprocess.py:93} INFO - +------+-------------+-------------+--------------------+-----------------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+---------------+-------------------+-----------------+----------------------+----------------------+---------------+
[2025-11-24T19:05:25.861+0000] {subprocess.py:93} INFO - only showing top 2 rows
[2025-11-24T19:05:25.861+0000] {subprocess.py:93} INFO - 
[2025-11-24T19:05:25.861+0000] {subprocess.py:93} INFO - --- TRATANDO DADOS ---
[2025-11-24T19:05:25.862+0000] {subprocess.py:93} INFO - --- MOSTRANDO DADOS ---
[2025-11-24T19:05:25.862+0000] {subprocess.py:93} INFO - +-----------+----------+-------------------+----------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+----------------+--------------------+--------------------+----------------------+----------------------+---------------+
[2025-11-24T19:05:25.862+0000] {subprocess.py:93} INFO - |ID_PACIENTE|      DATA|    HOR√ÅRIO_CHEGADA|    DATA_2|  HOR√ÅRIO_CHEGADA_2|     SEXO|IDADE|PESO_kg|ALTURA_m|  IMC|     ETAPA|CAFE√çNA|DIETA_NAS_√öLTIMAS_24_H|ATIVIDADE_mCi_Repouso|HORA_INJE√á√ÉO_Repouso|HORA_IMAGEM_Repouso|ATIVIDADE_mCi_Esfor√ßo|HORA_INJE√á√ÉO_Esfor√ßo|HORA_IMAGEM_Esfor√ßo|REPETIU| ETAPA_REPETI√á√ÉO| MOTIVO_DE_REPETI√á√ÉO|   PREPARO_REPETI√á√ÉO|HORA_REPETI√á√ÉO_Repouso|HORA_REPETI√á√ÉO_Estress|N_num_REPETI√á√ÉO|
[2025-11-24T19:05:25.863+0000] {subprocess.py:93} INFO - +-----------+----------+-------------------+----------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+----------------+--------------------+--------------------+----------------------+----------------------+---------------+
[2025-11-24T19:05:25.863+0000] {subprocess.py:93} INFO - |     209233|2025-03-05|2025-11-22 09:12:00|2025-03-06|2025-11-22 09:15:00|Masculino|   68|     84|    1.72|28.39|Incompleta|  false|  P√£es, Aves, Leite...|                 16.0| 2025-11-22 09:25:00|2025-11-22 10:33:00|                 16.0| 2025-11-22 10:45:00|2025-11-22 11:28:00|   true|Repouso, Esfor√ßo|Atividade Hepatic...|√Ågua com G√°s, Lei...|   2025-11-22 11:27:00|   2025-11-22 12:34:00|              1|
[2025-11-24T19:05:25.863+0000] {subprocess.py:93} INFO - |     235366|2025-03-06|2025-11-22 12:44:00|2025-03-07|2025-11-22 10:50:00| Feminino|   75|     62|    1.68|21.97|Incompleta|  false|  P√£es, Cereais, Gr...|                 15.0| 2025-11-22 13:25:00|2025-11-22 14:37:00|                 15.0| 2025-11-22 12:05:00|2025-11-22 12:56:00|   true|         Repouso|                NULL|                NULL|   2025-11-22 15:13:00|                  NULL|              1|
[2025-11-24T19:05:25.864+0000] {subprocess.py:93} INFO - +-----------+----------+-------------------+----------+-------------------+---------+-----+-------+--------+-----+----------+-------+----------------------+---------------------+--------------------+-------------------+---------------------+--------------------+-------------------+-------+----------------+--------------------+--------------------+----------------------+----------------------+---------------+
[2025-11-24T19:05:25.864+0000] {subprocess.py:93} INFO - only showing top 2 rows
[2025-11-24T19:05:25.864+0000] {subprocess.py:93} INFO - 
[2025-11-24T19:05:25.865+0000] {subprocess.py:93} INFO - --- ESCREVENDO DADOS EM SILVER ---
[2025-11-24T19:05:25.865+0000] {subprocess.py:93} INFO - Delta Lake Time Travel conclu√≠do com sucesso!
[2025-11-24T19:05:26.293+0000] {subprocess.py:93} INFO - ‚úÖ Silver Layer executado com sucesso!
[2025-11-24T19:05:31.295+0000] {subprocess.py:93} INFO - üìä Verificando dados gerados...
[2025-11-24T19:05:31.296+0000] {subprocess.py:93} INFO - ==============================================
[2025-11-24T19:05:31.297+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-24T19:05:31.332+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=etl_spark_working, task_id=execute_silver_layer, execution_date=20251124T190302, start_date=20251124T190501, end_date=20251124T190531
[2025-11-24T19:05:31.373+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-11-24T19:05:31.404+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
